<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title></title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="subroutines" class="slide level1">
<h1>Subroutines</h1>
<p>Brandon Seah</p>
<p>Perl Course 2017</p>
</section>
<section class="slide level1">

<h2 id="language-is-built-on-abstraction">Language is built on abstraction</h2>
<ul>
<li class="fragment">“Wood fibers flattened, stacked, attached”</li>
<li class="fragment">“Paper stack, attached”</li>
<li class="fragment">“Book”</li>
</ul>
</section>
<section class="slide level1">

<h2 id="math-is-built-on-abstraction">Math is built on abstraction</h2>
<p><span class="math inline">$\frac{n_1 + n_2}{2}$</span></p>
<p><span class="math inline">$\frac{n_1 + n_2 + n_3}{3}$</span></p>
<p>etc.</p>
<p>“Sum”, “Mean”</p>
</section>
<section class="slide level1">

<h2 id="code-is-built-on-abstraction">Code is built on abstraction</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">my</span> <span class="dt">$number</span> = <span class="dv">3</span>;
<span class="kw">my</span> <span class="dt">$result</span> = <span class="dt">$number*$</span>number*<span class="dt">$number</span>;
<span class="kw">my</span> <span class="dt">$result2</span> = <span class="dt">$number**</span><span class="dv">3</span>; <span class="co"># Built-in operator</span></code></pre></div>
</section>
<section class="slide level1">

<h2 id="perl-the-language-vs.-perl-the-interpreter">Perl the language vs. <code>perl</code> the interpreter</h2>
<p>Perl is written in C</p>
<figure>
<img src="perl_source.png" />
</figure>
</section>
<section class="slide level1">

<h2 id="levels-of-abstraction">Levels of abstraction</h2>
<ul>
<li class="fragment">Perl is written in C</li>
<li class="fragment">C compiler is written in ... C (?!)</li>
<li class="fragment">Interpreter translates human-readable code to machine code</li>
<li class="fragment">Machine code is specific to hardware type</li>
</ul>
</section>
<section class="slide level1">

<h2 id="machines-simulating-machines">Machines simulating machines</h2>
<p><a href="https://youtu.be/go5qdMKZs-M">Minecraft computer (Trailer)</a></p>
<p><a href="https://en.wikipedia.org/wiki/Virtual_machine">Virtual machines</a></p>
</section>
<section class="slide level1">

<h2 id="make-your-own-abstractions">Make your own abstractions</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">my</span> <span class="dt">$number</span> = <span class="dv">3</span>;
<span class="kw">my</span> <span class="dt">$result</span> = power(<span class="dt">$number</span>,<span class="dv">2</span>);
<span class="kw">sub </span><span class="fu">power</span> {
  <span class="kw">my</span> (<span class="dt">$num</span>, <span class="dt">$exp</span>) = <span class="dt">@_</span>; <span class="co"># Inputs</span>
  <span class="kw">my</span> <span class="dt">$output</span> = <span class="dv">1</span>;
  <span class="kw">for</span> (<span class="kw">my</span> <span class="dt">$i</span>=<span class="dv">1</span>; <span class="dt">$i</span> &lt;= <span class="dt">$exp</span>; <span class="dt">$i</span>++) {
    <span class="dt">$output</span> = <span class="dt">$output</span> <span class="kw">*</span> <span class="dt">$num</span>;
  }
  <span class="kw">return</span> <span class="dt">$output</span>; <span class="co"># Output</span>
}</code></pre></div>
<p>What happens if <code>$exp &lt;= 0</code>?</p>
</section>
<section class="slide level1">

<h2 id="benefits-of-abstraction">Benefits of abstraction</h2>
<ul>
<li>Avoid repetition</li>
<li>Code is cleaner</li>
<li>Changes only made once</li>
<li>Reduce human error</li>
<li>Build abstractions</li>
<li>Easier to read code</li>
<li>Easier to write code</li>
</ul>
</section>
<section class="slide level1">

<h2 id="sub-blocks-can-go-anywhere"><code>sub</code> blocks can go anywhere</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">sub </span><span class="fu">say_hello</span> { <span class="fu">print</span> <span class="kw">&quot;</span><span class="st">Hello!</span><span class="ch">\n</span><span class="kw">&quot;</span>; }
say_hello();</code></pre></div>
<p>Equivalent to:</p>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl">say_hello();
<span class="kw">sub </span><span class="fu">say_hello</span> { <span class="fu">print</span> <span class="kw">&quot;</span><span class="st">Hello!</span><span class="ch">\n</span><span class="kw">&quot;</span>; }</code></pre></div>
</section>
<section class="slide level1">

<h2 id="scoping-of-variables-in-a-sub-block">Scoping of variables in a <code>sub</code> block</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">sub </span><span class="fu">cube_it</span> {
    <span class="kw">my</span> (<span class="dt">$input</span>) = <span class="dt">@_</span>;
    <span class="kw">my</span> <span class="dt">$out</span> = <span class="dt">$input**</span><span class="kw">*</span><span class="dv">3</span>;
    <span class="kw">return</span> <span class="dt">$out</span>;
}
<span class="fu">print</span> <span class="dt">$out</span>; <span class="co"># Doesn&#39;t exist outside block</span></code></pre></div>
</section>
<section class="slide level1">

<h2 id="input-to-a-function">Input to a function</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">sub </span><span class="fu">cube_it</span> {
    <span class="kw">my</span> (<span class="dt">$input</span>) = <span class="dt">@_</span>;
    <span class="kw">my</span> <span class="dt">$out</span> = <span class="dt">$input**</span><span class="kw">*</span><span class="dv">3</span>;
    <span class="kw">return</span> <span class="dt">$out</span>;
}</code></pre></div>
<ul>
<li>Inputs are passed to a special array called <code>@_</code></li>
<li>Even if there is only one input, still goes to an array</li>
</ul>
</section>
<section class="slide level1">

<h2 id="calling-a-subroutine-with-input-and-return-value">Calling a subroutine with input and return value</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">sub </span><span class="fu">cube_it</span> {
    <span class="kw">my</span> (<span class="dt">$input</span>) = <span class="dt">@_</span>;
    <span class="kw">my</span> <span class="dt">$out</span> = <span class="dt">$input**</span><span class="kw">*</span><span class="dv">3</span>;
    <span class="kw">return</span> <span class="dt">$out</span>;
}
<span class="kw">my</span> <span class="dt">$answer</span> = cube_it(<span class="dv">3</span>);
<span class="fu">print</span> <span class="dt">$answer</span>.<span class="kw">&quot;</span><span class="ch">\n</span><span class="kw">&quot;</span>;</code></pre></div>
</section>
<section class="slide level1">

<h2 id="exercise-matching-fasta-headers">Exercise: Matching Fasta headers</h2>
<p>Convert the following script to use a subroutine</p>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">while</span> (&lt;&gt;) {
  <span class="kw">if</span> (<span class="dt">$_</span> =~ <span class="kw">m/</span><span class="ch">^</span><span class="ot">&gt;</span><span class="kw">/</span>) {
    <span class="fu">print</span> <span class="kw">&quot;</span><span class="st">Header found</span><span class="ch">\n</span><span class="kw">&quot;</span>;
  } <span class="kw">else</span> {
    <span class="fu">print</span> <span class="kw">&quot;</span><span class="st">Not a header</span><span class="ch">\n</span><span class="kw">&quot;</span>;
  }
}</code></pre></div>
<p><small>File: XXX</small></p>
</section>
<section class="slide level1">

<h2 id="exercise-matching-fasta-headers-1">Exercise: Matching Fasta headers</h2>
<p>One possible solution:</p>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">while</span> (&lt;&gt;) {
  <span class="fu">print</span> isheader(<span class="dt">$_</span>);
}
<span class="kw">sub </span><span class="fu">isheader</span> {
  <span class="kw">my</span> (<span class="dt">$input</span>) = <span class="dt">@_</span>;
  <span class="kw">if</span> (<span class="dt">$input</span> =~ <span class="kw">m/</span><span class="ch">^</span><span class="ot">&gt;</span><span class="kw">/</span>) {
    <span class="kw">return</span> <span class="kw">&quot;</span><span class="st">Header found</span><span class="ch">\n</span><span class="kw">&quot;</span>;
  } <span class="kw">else</span> {
    <span class="kw">return</span> <span class="kw">&quot;</span><span class="st">Not a header</span><span class="ch">\n</span><span class="kw">&quot;</span>;
  }
}</code></pre></div>
</section>
<section class="slide level1">

<h2 id="calling-a-subroutine-with-no-return-value">Calling a subroutine with no return value</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">sub </span><span class="fu">repeat_it</span> {
    <span class="kw">my</span> (<span class="dt">$input</span>) = <span class="dt">@_</span>;
    <span class="fu">print</span> <span class="kw">&quot;</span><span class="st">You said: </span><span class="dt">$input</span><span class="st">.</span><span class="kw">&quot;</span>\n<span class="kw">&quot;</span><span class="st">;</span>
<span class="st">}</span>
<span class="st">repeat_it(</span><span class="kw">&quot;</span>Hello<span class="kw">&quot;</span><span class="st">);</span>
<span class="st">my </span><span class="dt">$test</span><span class="st"> = repeat_it (</span><span class="kw">&quot;</span>Hello<span class="kw">&quot;</span><span class="st">);</span>
<span class="st">print </span><span class="dt">$test</span><span class="st">; # What happens?</span></code></pre></div>
</section>
<section class="slide level1">

<h2 id="calling-a-subroutine-with-no-inputs">Calling a subroutine with no inputs</h2>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">sub </span><span class="fu">random_fruit</span> {
    <span class="kw">my</span> <span class="dt">@fruit</span> = (<span class="kw">&quot;</span><span class="st">apple</span><span class="kw">&quot;</span>,<span class="kw">&quot;</span><span class="st">banana</span><span class="kw">&quot;</span>,<span class="kw">&quot;</span><span class="st">orange</span><span class="kw">&quot;</span>,<span class="kw">&quot;</span><span class="st">raspberry</span><span class="kw">&quot;</span>);
    <span class="kw">my</span> <span class="dt">$random</span> = <span class="fu">int</span>(<span class="fu">rand</span>(<span class="dv">3</span>));
    <span class="kw">return</span> <span class="dt">$fruit</span>[<span class="dt">$random</span>];
}
<span class="kw">my</span> <span class="dt">$choice</span> = random_fruit();
<span class="fu">print</span> <span class="dt">$choice</span>.<span class="kw">&quot;</span><span class="ch">\n</span><span class="kw">&quot;</span>;</code></pre></div>
<p>What happens if you wrote <code>my $choice = random_fruit;</code> instead?</p>
</section>
<section class="slide level1">

<h2 id="additional-material">Additional material</h2>
</section>
<section class="slide level1">

<h2 id="passing-arrayshashes-to-subroutine">Passing arrays/hashes to subroutine</h2>
<ul>
<li>Use <em>references</em> (see Day 2)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"><span class="kw">my</span> <span class="dt">@arr</span> = (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>);
add_arr(\<span class="dt">@arr</span>); <span class="co"># Notice backslash before @arr</span>
<span class="kw">sub </span><span class="fu">add_arr</span> {
  <span class="kw">my</span> <span class="dt">$arr_ref</span> = <span class="dt">@_</span>;
  <span class="kw">my</span> <span class="dt">@array</span> = <span class="dt">@$arr_ref</span>; <span class="co"># Dereference</span>
  <span class="kw">my</span> <span class="dt">$sum</span> = <span class="dv">0</span>;
  <span class="kw">foreach</span> <span class="kw">my</span> <span class="dt">$num</span> (<span class="dt">@array</span>) {
    <span class="dt">$sum</span> += <span class="dt">$num</span>;
  }
  <span class="kw">return</span> (<span class="dt">$sum</span>);
}</code></pre></div>
</section>
<section class="slide level1">

<h2 id="peculiarities-of-subroutines-in-perl">Peculiarities of subroutines in Perl</h2>
<ul>
<li>Called &quot;subroutines&quot; instead of &quot;functions&quot;</li>
<li>Need parantheses even for functions without inputs</li>
<li>Accepts only lists of scalars as inputs</li>
<li>Input arguments are not directly defined</li>
<li>In older versions of Perl, subroutines needed sigil <code>&amp;</code></li>
</ul>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
              { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
